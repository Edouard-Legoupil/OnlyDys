<!DOCTYPE html>
<html>

<head>
    <title>OnlyDys</title>
    <meta charset="UTF-8">
    <script type="text/javascript" src="https://onlyoffice.github.io/sdkjs-plugins/v1/plugins.js"></script>
    <script type="text/javascript" src="https://onlyoffice.github.io/sdkjs-plugins/v1/plugins-ui.js"></script>
    <link rel="stylesheet" href="https://onlyoffice.github.io/sdkjs-plugins/v1/plugins.css">

    <link rel="stylesheet" href="resources/css/plugin_style.css">

    <script type="text/javascript" src="scripts/logger.js"></script>
    <script type="text/javascript" src="scripts/suggestionLogic.js"></script>
    <script type="text/javascript" src="scripts/suggestionUI.js"></script>
    <script type="text/javascript" src="scripts/styleManager.js"></script>
    <script type="text/javascript" src="scripts/dyslexia.js"></script>
    <script type="text/javascript" src="scripts/linguisticEngine.js"></script>
    <script type="text/javascript" src="scripts/colorizationEngine.js"></script>
    <script type="text/javascript" src="scripts/arcRenderer.js"></script>
    <script type="text/javascript" src="scripts/selectionManager.js"></script>
    <script type="text/javascript" src="scripts/configManager.js"></script>
    <script type="text/javascript" src="scripts/pictogramService.js"></script>
    <script type="text/javascript" src="scripts/plugin.js"></script>
</head>

<body>
    <div class="tab-bar">
        <button class="tab-button active" data-tab="suggestions">Ecrire</button>
        <button class="tab-button" data-tab="linguistics">Lire</button>
        <button id="font-tab-btn" class="tab-button" data-tab="font" style="display: none;">Font</button>
        <button class="tab-button" data-tab="about">A propos</button>
    </div>

    <div id="tab-content" class="tab-content">
        <!-- SUGGESTIONS TAB -->
        <div id="tab-suggestions" class="tab-pane active">
            <div style="margin: 12px 12px 4px 12px; width: calc(100% - 24px);">
                <div class="toggle-switch-container">
                    <label class="switch">
                        <input type="checkbox" id="toggle-suggestion-mode" checked>
                        <span class="slider round"></span>
                    </label>
                    <span id="suggestion-mode-status" style="margin-left: 10px; font-weight: bold;">Au fur et √† mesure</span>
                </div>
            </div>

            <div id="suggestions-container"
                style="position: relative; width: calc(100% - 24px); margin: 0 12px; overflow-y: auto;">
                <!-- Suggestions will be added here dynamically -->
            </div>
        </div>

        <!-- LINGUISTICS TAB -->
        <div id="tab-linguistics" class="tab-pane">
            <div class="linguistics-container">

                <div class="control-group">
                    <label class="section-label">Type d'aide :</label>
                    <div id="ling-category-radios" class="radio-group"
                        style="display: flex; flex-wrap: wrap; gap: 8px;">
                        <label class="radio-label"><input type="radio" name="ling-category" value="none" checked>
                            Aucun</label>
                        <label class="radio-label"><input type="radio" name="ling-category" value="grammar">
                            Grammaire</label>
                        <label class="radio-label"><input type="radio" name="ling-category" value="linguistic">
                            Linguistique</label>
                        <label class="radio-label"><input type="radio" name="ling-category" value="alternance">
                            Alternance</label>
                        <label class="radio-label"><input type="radio" name="ling-category" value="highlight"> Mise en
                            √©vidence</label>
                    </div>
                </div>

                <div id="ling-mode-container" class="control-group" style="display: none; margin-top: 10px;">
                    <label class="section-label">Mode sp√©cifique :</label>
                    <div id="ling-mode-radios" class="radio-group">
                        <!-- Populated via JS -->
                    </div>
                </div>

                <div id="ling-options"
                    style="margin-top: 15px; border-top: 1px dashed #ccc; padding-top: 10px; min-height: 20px;">

                    <!-- Global Colorization Options -->
                    <div style="margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px dashed #eee;">
                        <div class="checkbox-group">
                            <input type="checkbox" id="opt-highlighting">
                            <label for="opt-highlighting">Utiliser le surlignage (fond color√©)</label>
                        </div>
                    </div>

                    <!-- Conditional Options -->
                    <div id="opt-container-letters" class="conditional-opt" style="display:none;">
                        <div class="input-group">
                            <label for="ling-target-letters" style="font-size: 0.9em;">Lettres √† mettre en √©vidence
                                :</label>
                            <input type="text" id="ling-target-letters" value="bdpq" class="form-control"
                                style="width: 100%; margin-top: 5px; padding: 4px; border: 1px solid #ccc; border-radius: 4px;">
                        </div>
                    </div>
                    <div id="opt-container-syllables" class="conditional-opt" style="display:none;">
                        <div class="checkbox-group">
                            <input type="checkbox" id="opt-arcs">
                            <label for="opt-arcs">Arcs des syllabes</label>
                        </div>
                    </div>

                    <div id="opt-container-silent" class="conditional-opt" style="display:none;">
                        <div class="checkbox-group">
                            <input type="checkbox" id="opt-silent">
                            <label for="opt-silent">Lettres silencieuses (gris)</label>
                        </div>
                    </div>

                    <div id="opt-container-grammar" class="conditional-opt" style="display:none;">
                        <div id="color-legend" class="color-legend"></div>
                    </div>
                </div>

                <!-- Preview area removed for compactness or keep if needed. Keeping it for now. -->
                <div class="preview-area">
                    <strong>Aper√ßu:</strong>
                    <div id="ling-preview">L'oiseau chante sur la branche.</div>
                </div>

                <!-- Actions removed for immediate application -->
                <div class="actions" style="display:none;">
                    <button id="btn-apply-ling" class="primary">Appliquer</button>
                    <button id="btn-reset-ling">Effacer</button>
                </div>

                <div id="ling-status" style="margin-top: 10px; font-size: 0.9em; color: #666;"></div>

                <hr style="margin: 20px 0; border: 0; border-top: 1px solid #ccc;">

                <h3>Formatage</h3>

                <div class="toggle-switch-container">
                    <label class="switch">
                        <input type="checkbox" id="toggle-global-style">
                        <span class="slider round"></span>
                    </label>
                    <span id="global-style-status" style="margin-left: 10px; font-weight: bold;">D√©sactiv√©</span>
                </div>
                <p class="help-text" style="font-size: 0.85em; color: #666; margin-top: 5px;">Applique la police
                    OpenDyslexic et un espacement adapt√©.</p>

                <hr style="margin: 20px 0; border: 0; border-top: 1px solid #ccc;">
                <h3>Simuler la dyslexie</h3>


                <div class="toggle-switch-container" style="margin-bottom: 20px;">
                    <label class="switch">
                        <input type="checkbox" id="toggle-dyslexia-sim">
                        <span class="slider round"></span>
                    </label>
                    <span id="dyslexia-sim-status" style="margin-left: 10px; font-weight: bold;">Inactif</span>
                </div>
                <p class="help-text" style="font-size: 0.85em; color: #666; margin-top: 5px;">Cette fonction applique un
                    effet pour simuler la fa√ßon dont une personne atteinte de dyslexie
                    pourrait percevoir ce document afin de mieux sensibiliser √† la dyslexie des personnes qui ne le
                    seraient pas d√©j√†.
                </p>


            </div>
        </div>


        <!-- FONT TAB -->
        <div id="tab-font" class="tab-pane">
            <div style="padding: 10px;">
                <div id="font-status"></div>
                <div id="font-instructions" style="display:none;">
                    <p>Pour ameliorer la lisibilite, ce plugin uitilise la police "OpenDyslexic". Veuillez suivre ces
                        instructions pour l'installer:</p>
                    <ol>
                        <li>T√©l√©chargez la police depuis le site officiel: <a href="https://opendyslexic.org/"
                                target="_blank">OpenDyslexic.org</a></li>
                        <li>Suivez les instructions d'installation pour votre syst√®me d'exploitation (Windows, macOS, ou
                            Linux).
                        </li>
                        <li>Une fois install√©, red√©marrez votre editeur ONLYOFFICE pour que la police soit disponible.
                        </li>
                    </ol>
                </div>
                <button id="check-font-button" class="primary" style="margin-top: 10px;">Re-check Font
                    Installation</button>
            </div>
        </div>

        <!-- ABOUT TAB -->
        <div id="tab-about" class="tab-pane">
            <div class="about-container">
                <p>Ce plugin impl√©mente un ensemble d'algorithmes pour aider les personnes dyslexiques (en fran√ßais).
                </p>

                <ul>
                    <li>
                        <strong>1. Aide √† l'√©criture:</strong> Le mode "Au fur et √† mesure" analyse et propose des corrections en temps r√©el. Le mode "Pour la s√©lection" analyse les 9 premiers mots de la s√©lection. Les corrections sont bas√©es sur les 4 confusions les plus courantes:
                        <ul>
                            <li> ü†≤ <strong>Confusions Visuelles: ‚ö†Ô∏è</strong> <span
                                    class="color-sample vermilion"></span>
                                b/d,
                                p/q, etc.</li>
                            <li> ü†≤ <strong>Confusions Phon√©tiques: üîä</strong> <span
                                    class="color-sample orange"></span>
                                f/v,
                                s/z, etc.</li>
                            <li> ü†≤ <strong>Homophones: üîÄ</strong> <span class="color-sample purple"></span> a/√†,
                                et/est,
                                etc.
                            </li>
                            <li> ü†≤ <strong>Erreurs Morphologiques: üìù</strong> <span class="color-sample blue"></span>
                                accords.</li>
                        </ul>
                    </li>
                    <li>
                        <strong>2. Aide √† la lecture:</strong> Colorisation par cat√©gorie grammaticale, syllabes, sons
                        et reformattage adapt√©.
                    </li>
                </ul>

                <p>Le projet est <a href="https://github.com/Edouard-Legoupil/OnlyDys" target="_blank">open-source</a>.
                    Vous utilisez la version 0.1.0 et pouvez <a
                        href="https://github.com/Edouard-Legoupil/OnlyDys/issues/new" target="_blank">signaler ici un
                        probl√®me</a></p>


                <div style="margin-top: 20px; text-align: center;">
                    <button id="btn-download-logs"
                        style="font-size: 11px; padding: 5px 10px; background-color: #f0f0f0; border: 1px solid #ccc; cursor: pointer;">Download
                        Debug Logs</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Pictogram Modal -->
    <div id="pictogram-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <div id="pictogram-container">
                <!-- Pictogram will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Shared Placeholder function for TTS -->
    <script>
        function lireMot(word) {
            console.log("Lecture du mot :", word);
            // Future implementation: TTS API
        }
    </script>
</body>

</html>